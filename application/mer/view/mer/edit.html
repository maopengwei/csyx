{include file="public/_meta" /}
<title>商品管理</title>
<link href="/static/admin/lib/webuploader/0.1.5/webuploader.css" rel="stylesheet" type="text/css" />
</head>
<style>

.lbwxq_mImg {
    width: 110px;
    height: 110px;
    border: 1px solid #eee;
    position: relative;
}

.lbwxq_mImg img {
    width: 110px;
    height: 110px;
}


.big img{
    width: 1000px;
    height: 1000px;
}

/*大图*/

.lbwxq_lImg {
    width: 500px;
    height: 500px;
    position: absolute;
    left: 540px;
    top: 25px;
    display: none;
    overflow: hidden;
}

.lbwxq_lImg img {
    width: 1000px;
    height: 1000px;
}


.pic {
    display: inline-block;
}

.pic img {
    width: 110px;
    height: 110px;
}
.big{
   position: absolute;
    right: 15%;
    top: 120px;
    width: 400px;
    height: 400px;
}
.big img{
    width: 100%;
    height: 100%;
}
</style>
<body>
    <nav class="breadcrumb"><i class="Hui-iconfont">&#xe67f;</i> 首页
        <span class="c-gray en">&gt;</span> 店铺管理
        <span class="c-gray en">&gt;</span> 门店编辑
        <a class="btn btn-success radius r" style="line-height:1.6em;margin-top:3px" href="javascript:location.replace(location.href);" title="刷新"><i class="Hui-iconfont">&#xe68f;</i></a>
    </nav>
    <div class="page-container">
        <form class="form form-horizontal" id="form-article-add">
            <div id="tab-system" class="HuiTab">
                <div class="tabBar cl">
                    <span>基础信息</span>
                    <span>门店信息</span>
                    <!-- <span>产品主图</span> -->
                    <span>门店详情</span>
                </div>
                <!-- 基础信息 -->
                <div class="tabCon">
                   <div class="row cl">
                        <label class="form-label col-xs-4 col-sm-2">关联账户：</label>
                        <div class="formControls col-xs-8 col-sm-9">
                            <input type="text" class="input-text" placeholder="用户名称" value="{$info.us_text}" style="width:20%" disabled>
                        </div>
                    </div>

                    <div class="row cl">
                        <label class="form-label col-xs-4 col-sm-2">门店名称：</label>
                        <div class="formControls col-xs-8 col-sm-9">
                            <input type="text" class="input-text" placeholder="门店名称" name="mer_name" value="{$info.mer_name}" style="width:20%">
                        </div>
                    </div>
                   
                    
                    <div class="row cl">
                        <label class="form-label col-xs-4 col-sm-2">门店分类：</label>
                        <div class="formControls col-xs-8 col-sm-9">
                            <dl class="permission-list">
                                <dd>
                                    <dl class="cl permission-list2">
                                        <dd>
                                            {volist name="gift" id="vo"}
                                            <label class="">
                                                <input type="checkbox" value="{$vo.id}" name="mer_gift[]" id="user-Character-1-0-0" class="authrule" >{$vo.cate_name}
                                            </label>
                                            {/volist}
                                        </dd>
                                    </dl>
                                </dd>
                            </dl>
                        </div>
                    </div> 
                     
                    <div class="row cl ttt" style="display:none">
                        <!-- volist name="$info.prod_pic" id="vo"
                        <input type="text" name="prod_pic[]" class="ppp" value="$vo">
                        /volist -->
                        <label class="form-label col-xs-4 col-sm-2"><span class="c-red">*</span>隐藏的：</label>
                        <div class="formControls col-xs-8 col-sm-9">
                            <input type="text" class="input-text" name="id" value="{$info.id}" style="width:50%">
                            <input type="text" class="input-text" name="mer_logo" value="{$info.mer_logo}">
                            <input type="text" class="input-text" name="mer_pic"  value="{$info.mer_pic}">
                            <!-- <input type="file" class="input-text" class="click_file" onchange="preview(this)"> -->
                        </div>
                    </div>
                </div>
                <!-- 产品价格 -->
                <div class="tabCon">
                    <div class="row cl">
                        <label class="form-label col-xs-4 col-sm-2">商铺电话：</label>
                        <div class="formControls col-xs-8 col-sm-9">
                            <input type="text" class="input-text" name="mer_tel" value="{$info.mer_tel}" style="width:35%">
                        </div>
                    </div>
                    <div class="row cl">
                        <label class="form-label col-xs-4 col-sm-2">商铺负责人：</label>
                        <div class="formControls col-xs-8 col-sm-9">
                            <input type="text" class="input-text" name="mer_owner" value="{$info.mer_owner}" style="width:35%">
                        </div>
                    </div>
                    <div class="row cl">
                        <label class="form-label col-xs-4 col-sm-2">商铺地址：</label>
                        <div class="formControls col-xs-8 col-sm-9">
                            <input type="text" class="input-text" name="mer_stree" value="{$info.mer_stree}" style="width:35%">
                        </div>
                    </div>
                    <div class="row cl">
                        <label class="form-label col-xs-4 col-sm-2">经营类型：</label>
                        <div class="formControls col-xs-8 col-sm-9">
                            <input type="text" class="input-text" name="mer_trade" value="{$info.mer_trade}" style="width:60%">
                        </div>
                    </div>
                    <div class="row cl">
                        <label class="form-label col-xs-4 col-sm-2">门店logo 1：1</label>
                        <div class="formControls col-xs-8 col-sm-9">
                            <div style="width:110px;height: 110px;position: relative;display: inline-block; ">
                                <img src="{$info.mer_logo?:'/static/admin/img/add0.png'}" alt="" class="logo" style="position: absolute;left: 0;top: 0;width: 100%;height: 100%;">
                                <input type="file" name="file" onchange="eee($(this),1)" class="input-text" style="position: absolute;left: 0;top: 0;width: 100%;height: 100%;opacity: 0;">
                            </div>
                        </div>
                    </div>

                    <div class="row cl">
                        <label class="form-label col-xs-4 col-sm-2">门店背景图 25：12</label>
                        <div class="formControls col-xs-8 col-sm-9">
                            <div style="width:200px;height: 110px;position: relative;display: inline-block; ">
                                    <img src="{$info.mer_pic?:'/static/admin/img/add0.png'}" class="pic" style="position: absolute;left: 0;top: 0;width: 100%;height: 100%;">
                                    <input type="file" name="file" onchange="eee($(this),2)" class="input-text" style="position: absolute;left: 0;top: 0;width: 100%;height: 100%;opacity: 0;">
                            </div>
                        </div>
                    </div>

                    <div class="row cl">
                        <label class="form-label col-xs-4 col-sm-2"><span class="c-red">*</span>商铺状态：</label>
                        <div class="formControls col-xs-8 col-sm-9 skin-minimal">
                            <div class="radio-box">
                                <input name="mer_status" type="radio" value="1" >
                                <label for="sex-1">正常</label>
                            </div>
                            <div class="radio-box">
                                <input name="mer_status" type="radio" value="0"  >
                                <label for="sex-2">未上线</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row cl">
                        <label class="form-label col-xs-4 col-sm-2">添加时间：</label>
                        <div class="formControls col-xs-8 col-sm-9">
                            <input type="text" class="input-text" value="{$info.mer_add_time}" disabled style="width:60%">
                        </div>
                    </div>
                </div>
                <!-- 产品主图 -->
               <!--  <div class="tabCon">
                     <div class="row cl">
                        <label class="form-label col-xs-4 col-sm-2">门店主图：</label>
                        <div class="formControls col-xs-8 col-sm-9">
                            <div class="pic" >
                                volist name="$info.prod_pic" id="vo"
                              <li class="maomao" style="position: relative; list-style: none;float: left">
                                <i class="Hui-iconfont ioc_x" onclick="remove_li(this)"  style="position: absolute;right: 0; top: 0;">&#xe6e2;</i>
                                <img  src="$vo" onclick="ccc(this)"  alt="">
                              </li>
                                /volist
                            </div>
                            <div style="width:110px;height: 110px;position: relative;display: inline-block; ">
                                <img src="/static/admin/img/add0.png" alt="" style="position: absolute;left: 0;top: 0;width: 100%;height: 100%;">
                                <input type="file" name="file" onchange="bbb($(this))" class="input-text" style="position: absolute;left: 0;top: 0;width: 100%;height: 100%;opacity: 0;">
                            </div>
                        </div>
                    </div>
                </div> -->
                
                <!-- 详细内容 -->
                <div class="tabCon">
                    <div class="row cl">
                        <label class="form-label col-xs-4 col-sm-2">详细内容：</label>
                        <div class="formControls col-xs-8 col-sm-9"> 
                            <textarea id="editor" type="text/plain" name="mer_detail" style="width:100%;height:400px;">
                               {$info.mer_detail|raw}
                            </textarea>
                        </div>
                    </div>
                </div>
                <div class="row cl">
                    <div class="col-xs-8 col-sm-9 col-xs-offset-4 col-sm-offset-2">
                        <button onclick="return edit();" class="btn btn-primary radius" type="submit"><i class="Hui-iconfont">&#xe632;</i>保存</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
    {include file="public/_footer" /}
    <script type="text/javascript" src="/static/admin/lib/ueditor/1.4.3/ueditor.config.js"></script>
    <script type="text/javascript" src="/static/admin/lib/ueditor/1.4.3/ueditor.all.min.js"> </script>
    <script type="text/javascript" src="/static/admin/lib/ueditor/1.4.3/lang/zh-cn/zh-cn.js"></script>
    <!--请在下方写此页面业务相关的脚本-->
    <script type="text/javascript">
        var mer_status = "{$info.mer_status}";
        var mer_is_zi = "{$info.mer_is_zi}";
        // console.log(mer_status);
        // $('select[name="mer_status"]').val(mer_status);
        $('input[name="mer_status"][value="'+mer_status+'"]').attr("checked",true);
        $('input[name="mer_is_zi"][value="'+mer_is_zi+'"]').attr("checked",true);
        // $('input[name="prod_is_hot"][value='+"$info.prod_is_hot"+']').attr("checked",true);
        
        $(function() {

            var aa = "{$info.mer_gift}";
            var rules=aa.split(",");
            $('.authrule').each(function(){
                if( $.inArray(this.value,rules)>-1){
                    $(this).attr('checked',true);
                }
            });


            $('.skin-minimal input').iCheck({
                checkboxClass: 'icheckbox-blue',
                radioClass: 'iradio-blue',
                increaseArea: '20%'
            });
            $("#tab-system").Huitab({
                index: 0
            });
            var ue = UE.getEditor('editor');
        }) 



        function eee(dada,type) {
            var data = new FormData();
            data.append('file', dada[0].files[0]);
            var index = layer.load(1, { shade: false }); //0代表加载的风格，支持0-2
            $.ajax({
                url: '{:url("store/upload")}',
                type: 'POST',
                data: data,
                cache: false,
                contentType: false,
                processData: false,
                success: function(data) {
                    layer.msg(data.msg);
                    if (data.code) {
                        if(type==1){
                            $('.logo').attr('src',data.data);
                            $('input[name="mer_logo"]').val(data.data);
                        }else{
                            $('.pic').attr('src',data.data);
                            $('input[name="mer_pic"]').val(data.data);
                        }
                    }
                        
                    layer.close(index);
                },
                error: function() {
                    layer.close(index);
                    layer.msg('上传出错');
                }
            });
        }
        //保存
        function edit() {
            $.post("{:url('edit')}", $('#form-article-add').serialize()).success(function(data) {
                layer.msg(data.msg);
                if (data.code) {
                   setTimeout(function(){
                        location.href = '';
                   },1000)
                }
            });
            return false;
        }
        // function bbb(dada) {
        //     var data = new FormData();
        //     data.append('file', dada[0].files[0]);
        //     var index = layer.load(1, { shade: false }); //0代表加载的风格，支持0-2
        //     $.ajax({
        //         url: '{:url("every/upload")}',
        //         type: 'POST',
        //         data: data,
        //         cache: false,
        //         contentType: false,
        //         processData: false,
        //         success: function(data) {
        //             // layer.msg(data.msg);
        //             if (data.code) {
        //                 var html1 = '<li class="maomao" style="position: relative; list-style: none;float: left"><i  onclick="remove_li(this)" class="Hui-iconfont ioc_x" style="position: absolute;right: 0; top: 0;">&#xe6e2;</i><img src="' + data.data + '"  onclick="ccc(this)" alt=""></li>';
        //                 var html2 = '<input name="prod_pic[]" class="ppp" hidden="hidden" value="'+data.data+'">';
        //                 $('.pic').append(html1);
        //                 $('.ttt').append(html2);
        //             }
        //             layer.close(index);
        //         },
        //         error: function() {
        //             layer.close(index);
        //             layer.msg('上传出错');
        //         }
        //     });
        // }
        function ccc(data){
            var path = $(data).attr('src');
            var html = '<img src="' + path + '" onclick="ddd()" alt="">';
            $('.big').html(html);
            $('.big').show();
        }
        function ddd(){
            $('.big').hide();
        }
        ddd();
        //删除主图
        // function remove_li(data){

        //     var index = $('.maomao i').index(data);
        //     $(data).parent().remove();
        //     // var path = $(data).next('img').attr('src');
        //     // var val = $('.ppp').eq(index).val();
        //     $('.ppp').eq(index).remove();
        // }
    </script>
    <!--/请在上方写此页面业务相关的脚本-->
</body>

</html>